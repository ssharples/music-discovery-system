import{j as e}from"./query-198de5fa.js";import{a as Q,r as m,R as z}from"./vendor-b1791c80.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function c(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(r){if(r.ep)return;r.ep=!0;const n=c(r);fetch(r.href,n)}})();var v={},F=Q;v.createRoot=F.createRoot,v.hydrateRoot=F.hydrateRoot;const G="",K=()=>{const x=window.location.protocol==="https:"?"wss:":"ws:",t=`client_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return`${x}//${window.location.host}/ws/${t}`};class V{async request(t,c){const l=`${G}${t}`,r=await fetch(l,{headers:{"Content-Type":"application/json",...c==null?void 0:c.headers},...c});if(!r.ok)throw new Error(`API Error: ${r.status} ${r.statusText}`);return r.json()}async startDiscovery(t){return this.request("/api/discovery/start",{method:"POST",body:JSON.stringify(t)})}async getDiscoverySessions(){return this.request("/api/sessions")}async getSessionDetails(t){return this.request(`/api/session/${t}`)}async getApiQuota(){return this.request("/api/analytics/quota")}async getArtists(t){const c=new URLSearchParams;t!=null&&t.skip&&c.append("skip",t.skip.toString()),t!=null&&t.limit&&c.append("limit",t.limit.toString()),t!=null&&t.status&&c.append("status",t.status),t!=null&&t.min_score&&c.append("min_score",t.min_score.toString());const l=c.toString(),r=l?`/api/artists?${l}`:"/api/artists";return this.request(r)}async getArtist(t){return this.request(`/api/artists/${t}`)}async getAnalytics(){return this.request("/api/analytics")}}const p=new V;function Y(){var A,q,L,R,P,C,I,O,W;const[x,t]=m.useState([]),[c,l]=m.useState(!1),[r,n]=m.useState(""),[o,j]=m.useState(null),[h,T]=m.useState(null),[N,H]=m.useState([]),[w,M]=m.useState([]),[S,$]=m.useState(null),[f,_]=m.useState(!1);m.useEffect(()=>{k(),y(),u(),b(),D();const s=setInterval(()=>{k(),u(),b()},3e4);return()=>clearInterval(s)},[]);const D=()=>{try{const s=K(),i=new WebSocket(s);i.onopen=()=>{_(!0),a("WebSocket connected - Real-time updates enabled")},i.onmessage=d=>{try{const g=JSON.parse(d.data);U(g)}catch(g){a(`WebSocket message error: ${g}`)}},i.onclose=()=>{_(!1),a("WebSocket disconnected"),setTimeout(D,5e3)},i.onerror=d=>{a(`WebSocket error: ${d}`)}}catch(s){a(`WebSocket setup failed: ${s}`)}},U=s=>{const{type:i,session_id:d,details:g,progress:E,summary:J}=s;switch(i){case"discovery_started":a(`üöÄ Discovery session ${d} started`),$(d),b();break;case"discovery_progress":a(`‚ö° Progress: ${E.phase} - ${E.message||"Processing..."}`);break;case"discovery_completed":a(`‚úÖ Discovery completed: ${J.artists_discovered} artists found`),l(!1),b(),y(),u();break;case"artist_processed":a(`üë§ Artist processed: ${g.artist_name}`);break;default:a(`üì® ${i}: ${s.timestamp}`)}},k=async()=>{try{const i=await(await fetch("/health")).json();j(i),a(`Health check: ${i.status}`)}catch(s){console.error("Health check failed:",s),j({status:"error",error:"Connection failed"}),a(`Health check failed: ${s}`)}},y=async()=>{try{const s=await p.getArtists({limit:20});t(s),a(`Loaded ${s.length} artists`)}catch(s){console.error("Failed to fetch artists:",s),a(`Failed to fetch artists: ${s}`)}},u=async()=>{try{const s=await p.getAnalytics();T(s)}catch(s){console.error("Failed to fetch analytics:",s),a(`Failed to fetch analytics: ${s}`)}},b=async()=>{try{const s=await p.getDiscoverySessions();M(s)}catch(s){console.error("Failed to fetch sessions:",s),a(`Failed to fetch sessions: ${s}`)}},a=s=>{const i=new Date().toLocaleTimeString();H(d=>[`[${i}] ${s}`,...d.slice(0,49)])},B=async()=>{l(!0),n('Starting discovery for "official music video"...'),a("Starting discovery session");try{const s={search_query:"official music video",max_results:50},i=await p.startDiscovery(s);n(`Discovery started: ${i.message}`),$(i.session_id),a(`üöÄ Discovery session started: ${i.session_id}`);const d=setInterval(async()=>{try{await y(),await u()}catch(g){a(`Progress check failed: ${g}`)}},1e4);setTimeout(()=>{clearInterval(d),l(!1),n("Discovery session completed"),a("Discovery session completed"),y(),u()},3e5)}catch(s){console.error("Discovery failed:",s),n(`Discovery failed: ${s}`),a(`Discovery failed: ${s}`),l(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-8",children:"üéõÔ∏è Music Discovery Admin Dashboard"}),e.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"System Health"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${(o==null?void 0:o.status)==="healthy"?"bg-green-500":(o==null?void 0:o.status)==="degraded"?"bg-yellow-500":"bg-red-500"}`})]}),(o==null?void 0:o.services)&&e.jsx("div",{className:"space-y-2",children:Object.entries(o.services).map(([s,i])=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"capitalize",children:[s,":"]}),e.jsx("span",{className:`font-medium ${i==="operational"?"text-green-600":"text-red-600"}`,children:i})]},s))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Real-time Updates"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${f?"bg-green-500":"bg-red-500"}`})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:["WebSocket: ",f?"Connected":"Disconnected"]}),e.jsxs("div",{children:["Live monitoring: ",f?"Active":"Offline"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Current Session"}),e.jsx("div",{className:"text-sm text-gray-600",children:S?e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-xs",children:S}),e.jsx("div",{className:`mt-2 inline-block px-2 py-1 rounded text-xs ${c?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:c?"Running":"Completed"})]}):e.jsx("div",{children:"No active session"})})]})]}),e.jsxs("div",{className:"mb-8 p-6 bg-white rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Discovery Control"}),e.jsx("p",{className:"text-gray-600 mb-4",children:'Run automated discovery for "official music video" search query'}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:B,disabled:c,className:`px-8 py-3 rounded-lg font-medium text-lg ${c?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:c?"Running Discovery...":"Run Discovery"}),c&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}),"Processing for up to 5 minutes..."]})]}),r&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-blue-800",children:r})})]}),h&&e.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"Total Artists"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.total_artists||0})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"High Value"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:h.high_value_artists||0})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"YouTube Quota"}),e.jsxs("p",{className:"text-lg font-bold text-orange-600 mt-2",children:[((q=(A=h.api_usage)==null?void 0:A.youtube)==null?void 0:q.requests_made)||0," / ",((R=(L=h.api_usage)==null?void 0:L.youtube)==null?void 0:R.quota_limit)||1e4]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${(((C=(P=h.api_usage)==null?void 0:P.youtube)==null?void 0:C.requests_made)||0)/(((O=(I=h.api_usage)==null?void 0:I.youtube)==null?void 0:O.quota_limit)||1e4)*100}%`}})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"Recent Discoveries"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:((W=h.recent_discoveries)==null?void 0:W.length)||0})]})]}),e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Discovery Sessions"})}),e.jsx("div",{className:"p-6",children:w.length===0?e.jsx("div",{className:"text-gray-500 text-center py-4",children:"No discovery sessions yet"}):e.jsx("div",{className:"space-y-3",children:w.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-mono text-gray-600",children:s.id}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Started: ",new Date(s.started_at).toLocaleString(),s.completed_at&&e.jsxs(e.Fragment,{children:[" ‚Ä¢ Completed: ",new Date(s.completed_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.artists_discovered||0})," artists"]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="running"?"bg-blue-100 text-blue-800":s.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s.status})]})]},s.id))})})]}),e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Live Activity Logs"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-gray-900 text-green-400 font-mono text-sm p-4 rounded-lg h-64 overflow-y-auto",children:N.length===0?e.jsx("div",{className:"text-gray-500",children:"No logs yet..."}):N.map((s,i)=>e.jsx("div",{className:"mb-1",children:s},i))})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-2xl font-semibold",children:["Discovered Artists (",x.length,")"]})}),e.jsx("div",{className:"p-6",children:x.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No artists discovered yet. Try starting a discovery session!"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:s.name}),s.genres.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Genres: "}),s.genres.slice(0,3).map((i,d)=>e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:i},d))]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.youtube_channel_name&&e.jsxs("div",{children:["üì∫ ",s.youtube_channel_name]}),s.location&&e.jsxs("div",{children:["üìç ",s.location]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Score: ",(s.enrichment_score*100).toFixed(0),"%"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.status==="discovered"?"bg-green-100 text-green-800":s.status==="enriched"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.status})]})]})]},s.id))})})]})]})})}v.createRoot(document.getElementById("root")).render(e.jsx(z.StrictMode,{children:e.jsx(Y,{})}));
//# sourceMappingURL=index-1d250039.js.map
