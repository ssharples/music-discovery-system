import{j as e}from"./query-198de5fa.js";import{a as K,r as u,R as X}from"./vendor-b1791c80.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))m(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&m(l)}).observe(document,{childList:!0,subtree:!0});function c(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function m(i){if(i.ep)return;i.ep=!0;const o=c(i);fetch(i.href,o)}})();var j={},U=K;j.createRoot=U.createRoot,j.hydrateRoot=U.hydrateRoot;const Z="",ee=()=>{const g=window.location.protocol==="https:"?"wss:":"ws:",r=`client_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return`${g}//${window.location.host}/ws/${r}`};class se{async request(r,c){const m=`${Z}${r}`,i=await fetch(m,{headers:{"Content-Type":"application/json",...c==null?void 0:c.headers},...c});if(!i.ok)throw new Error(`API Error: ${i.status} ${i.statusText}`);return i.json()}async startDiscovery(r){return this.request("/api/discover",{method:"POST",body:JSON.stringify(r)})}async getDiscoverySessions(){return this.request("/api/sessions")}async getSessionDetails(r){return this.request(`/api/session/${r}`)}async getApiQuota(){return this.request("/api/analytics/quota")}async getArtists(r){const c=new URLSearchParams;r!=null&&r.skip&&c.append("skip",r.skip.toString()),r!=null&&r.limit&&c.append("limit",r.limit.toString()),r!=null&&r.status&&c.append("status",r.status),r!=null&&r.min_score&&c.append("min_score",r.min_score.toString());const m=c.toString(),i=m?`/api/artists?${m}`:"/api/artists";return this.request(i)}async getArtist(r){return this.request(`/api/artists/${r}`)}async getAnalytics(){return this.request("/api/analytics")}}const f=new se;function te(){var R,L,C,P,I,W,O,F,E;const[g,r]=u.useState([]),[c,m]=u.useState(!1),[i,o]=u.useState(""),[l,N]=u.useState(null),[h,M]=u.useState(null),[w,_]=u.useState([]),[$,J]=u.useState([]),[S,k]=u.useState(null),[y,D]=u.useState(!1);u.useEffect(()=>{q(),b(),p(),v(),A();const s=setInterval(()=>{q(),p(),v()},3e4);return()=>clearInterval(s)},[]);const A=()=>{try{const s=ee(),a=new WebSocket(s);a.onopen=()=>{D(!0),t("WebSocket connected - Real-time updates enabled")},a.onmessage=x=>{try{const d=JSON.parse(x.data);B(d)}catch(d){t(`WebSocket message error: ${d}`)}},a.onclose=()=>{D(!1),t("WebSocket disconnected"),setTimeout(A,5e3)},a.onerror=x=>{t(`WebSocket error: ${x}`)}}catch(s){t(`WebSocket setup failed: ${s}`)}},B=s=>{var T;const{type:a,session_id:x,details:d,progress:n,summary:V}=s;switch(a){case"connection":t("🔗 WebSocket connected - Real-time updates enabled");break;case"discovery_started":t(`🚀 Discovery session started: ${x}`),t(`🔍 Search query: "${(d==null?void 0:d.search_query)||"unknown"}" (max ${(d==null?void 0:d.max_results)||0} results)`),k(x),v();break;case"discovery_progress":switch(n!=null&&n.message&&t(n.message),(n==null?void 0:n.progress)!==void 0&&o(`${n.message} (${Math.round(n.progress)}%)`),n==null?void 0:n.phase){case"youtube_discovery":t("🔍 Searching YouTube...");break;case"youtube_discovery_complete":t(`✅ Found ${n.artists_found||0} potential artists`);break;case"artist_processing":t("🎤 Starting artist enrichment pipeline...");break;case"processing_artist":n.current_artist&&t(`🔍 Processing: ${n.current_artist}`);break;case"artist_processed":n.enriched_count&&t(`✅ Successfully enriched ${n.enriched_count} artists so far`);break;case"artist_skipped":t("⚠️ Skipped artist (insufficient data)");break;case"artist_error":t(`❌ Error: ${n.error||"Unknown error"}`);break;case"pipeline_error":t(`💥 Pipeline failed: ${n.error||"Unknown error"}`),m(!1);break}break;case"discovery_completed":const{artists_discovered:H,videos_processed:Y,total_candidates:z,success_rate:G}=V||{};t("🎉 Discovery completed!"),t(`📊 Results: ${H||0} artists enriched from ${z||0} candidates`),t(`📹 ${Y||0} videos processed | Success rate: ${G||"0%"}`),m(!1),o(`Discovery completed: ${H||0} artists found`),v(),b(),p();break;case"artist_discovered":d!=null&&d.name&&(t(`🎤 New artist discovered: ${d.name} (score: ${((T=d.enrichment_score)==null?void 0:T.toFixed(2))||"N/A"})`),b());break;default:t(`📨 ${a}: ${JSON.stringify(s).substring(0,100)}...`)}},q=async()=>{try{const a=await(await fetch("/health")).json();N(a),t(`Health check: ${a.status}`)}catch(s){console.error("Health check failed:",s),N({status:"error",error:"Connection failed"}),t(`Health check failed: ${s}`)}},b=async()=>{try{const s=await f.getArtists({limit:20});r(s),t(`Loaded ${s.length} artists`)}catch(s){console.error("Failed to fetch artists:",s),t(`Failed to fetch artists: ${s}`)}},p=async()=>{try{const s=await f.getAnalytics();M(s)}catch(s){console.error("Failed to fetch analytics:",s),t(`Failed to fetch analytics: ${s}`)}},v=async()=>{try{const s=await f.getDiscoverySessions();J(s)}catch(s){console.error("Failed to fetch sessions:",s),t(`Failed to fetch sessions: ${s}`)}},t=s=>{const a=new Date().toLocaleTimeString();_(x=>[`[${a}] ${s}`,...x.slice(0,49)])},Q=async()=>{m(!0),o('Starting discovery for "official music video"...'),t("Starting discovery session");try{const s={search_query:"official music video",max_results:50},a=await f.startDiscovery(s);o(`Discovery started: ${a.message}`),k(a.session_id),t(`🚀 Discovery session started: ${a.session_id}`);const x=setInterval(async()=>{try{await b(),await p()}catch(d){t(`Progress check failed: ${d}`)}},1e4);setTimeout(()=>{clearInterval(x),m(!1),o("Discovery session completed"),t("Discovery session completed"),b(),p()},3e5)}catch(s){console.error("Discovery failed:",s),o(`Discovery failed: ${s}`),t(`Discovery failed: ${s}`),m(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-8",children:"🎛️ Music Discovery Admin Dashboard"}),e.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"System Health"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${(l==null?void 0:l.status)==="healthy"?"bg-green-500":(l==null?void 0:l.status)==="degraded"?"bg-yellow-500":"bg-red-500"}`})]}),(l==null?void 0:l.services)&&e.jsx("div",{className:"space-y-2",children:Object.entries(l.services).map(([s,a])=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"capitalize",children:[s,":"]}),e.jsx("span",{className:`font-medium ${a==="operational"?"text-green-600":"text-red-600"}`,children:a})]},s))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Real-time Updates"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${y?"bg-green-500":"bg-red-500"}`})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:["WebSocket: ",y?"Connected":"Disconnected"]}),e.jsxs("div",{children:["Live monitoring: ",y?"Active":"Offline"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Current Session"}),e.jsx("div",{className:"text-sm text-gray-600",children:S?e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-xs",children:S}),e.jsx("div",{className:`mt-2 inline-block px-2 py-1 rounded text-xs ${c?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:c?"Running":"Completed"})]}):e.jsx("div",{children:"No active session"})})]})]}),e.jsxs("div",{className:"mb-8 p-6 bg-white rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Discovery Control"}),e.jsx("p",{className:"text-gray-600 mb-4",children:'Run automated discovery for "official music video" search query'}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:Q,disabled:c,className:`px-8 py-3 rounded-lg font-medium text-lg ${c?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:c?"Running Discovery...":"Run Discovery"}),c&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}),"Processing for up to 5 minutes..."]})]}),i&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-blue-800",children:i})})]}),h&&e.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"Total Artists"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.total_artists||0})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"High Value"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:h.high_value_artists||0})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"YouTube Quota"}),e.jsxs("p",{className:"text-lg font-bold text-orange-600 mt-2",children:[((L=(R=h.api_usage)==null?void 0:R.youtube)==null?void 0:L.requests_made)||0," / ",((P=(C=h.api_usage)==null?void 0:C.youtube)==null?void 0:P.quota_limit)||1e4]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${(((W=(I=h.api_usage)==null?void 0:I.youtube)==null?void 0:W.requests_made)||0)/(((F=(O=h.api_usage)==null?void 0:O.youtube)==null?void 0:F.quota_limit)||1e4)*100}%`}})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-semibold text-gray-500 text-sm uppercase tracking-wide",children:"Recent Discoveries"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:((E=h.recent_discoveries)==null?void 0:E.length)||0})]})]}),e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Discovery Sessions"})}),e.jsx("div",{className:"p-6",children:$.length===0?e.jsx("div",{className:"text-gray-500 text-center py-4",children:"No discovery sessions yet"}):e.jsx("div",{className:"space-y-3",children:$.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-mono text-gray-600",children:s.id}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Started: ",new Date(s.started_at).toLocaleString(),s.completed_at&&e.jsxs(e.Fragment,{children:[" • Completed: ",new Date(s.completed_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.artists_discovered||0})," artists"]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="running"?"bg-blue-100 text-blue-800":s.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s.status})]})]},s.id))})})]}),e.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"🚀 Live Discovery Stream"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:`flex items-center space-x-2 ${y?"text-green-600":"text-red-600"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:y?"Live":"Disconnected"})]}),e.jsx("button",{onClick:()=>_([]),className:"text-sm px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Clear Logs"})]})]})}),e.jsxs("div",{className:"p-6",children:[c&&e.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"Discovery in Progress"}),e.jsx("div",{className:"text-xs text-blue-700 mt-1",children:i})]})]})}),e.jsxs("div",{className:"bg-gray-900 text-green-400 font-mono text-sm p-4 rounded-lg h-80 overflow-y-auto",children:[w.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx("div",{className:"text-2xl mb-2",children:"📡"}),e.jsx("div",{children:"Waiting for activity..."}),e.jsx("div",{className:"text-xs mt-2",children:"Real-time discovery logs will appear here"})]})}):e.jsx("div",{className:"space-y-1",children:w.map((s,a)=>e.jsx("div",{className:`transition-colors ${s.includes("❌")||s.includes("💥")?"text-red-400":s.includes("✅")||s.includes("🎉")?"text-green-400":s.includes("⚠️")?"text-yellow-400":s.includes("🔍")||s.includes("🎤")?"text-cyan-400":s.includes("📊")||s.includes("📹")?"text-purple-400":"text-gray-300"}`,children:s},a))}),e.jsx("div",{ref:s=>s==null?void 0:s.scrollIntoView({behavior:"smooth"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-2xl font-semibold",children:["Discovered Artists (",g.length,")"]})}),e.jsx("div",{className:"p-6",children:g.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No artists discovered yet. Try starting a discovery session!"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:s.name}),s.genres.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Genres: "}),s.genres.slice(0,3).map((a,x)=>e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1",children:a},x))]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.youtube_channel_name&&e.jsxs("div",{children:["📺 ",s.youtube_channel_name]}),s.location&&e.jsxs("div",{children:["📍 ",s.location]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Score: ",(s.enrichment_score*100).toFixed(0),"%"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.status==="discovered"?"bg-green-100 text-green-800":s.status==="enriched"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.status})]})]})]},s.id))})})]})]})})}j.createRoot(document.getElementById("root")).render(e.jsx(X.StrictMode,{children:e.jsx(te,{})}));
//# sourceMappingURL=index-5018197e.js.map
